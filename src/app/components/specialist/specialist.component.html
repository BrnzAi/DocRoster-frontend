<section
  class="specialist"
  aria-label="Specialist profile"
  [attr.data-specialist-id]="specialist()?.id ?? undefined"
>
  <button class="specialist__close" type="button" aria-label="Close profile" (click)="handleClose()">
    <img src="assets/anima/specialist/close.svg" alt="" />
  </button>

  <ng-container *ngIf="!isLoading(); else loadingState">
    <ng-container *ngIf="specialist() as currentSpecialist; else notFoundState">
      <figure class="specialist__portrait" aria-hidden="true">
        <img
          class="specialist__portrait-image"
          [alt]="currentSpecialist.avatarAlt"
          [src]="currentSpecialist.avatar"
        />
        <span class="specialist__portrait-fade"></span>
      </figure>

      <div class="specialist__content">
        <header class="specialist__heading">
          <h1 class="specialist__name">{{ currentSpecialist.name }}</h1>
          <span
            class="specialist__gender"
            [attr.aria-label]="genderIcon(currentSpecialist.gender).label"
          >
            <img [src]="genderIcon(currentSpecialist.gender).icon" alt="" />
          </span>
        </header>

        <p class="specialist__bio">
          <ng-container *ngFor="let line of splitLines(currentSpecialist.biography); let last = last">
            {{ line }}<br *ngIf="!last" />
          </ng-container>
        </p>

        <div class="specialist__actions" role="group" aria-label="Contact actions">
          <button
            type="button"
            class="specialist__action specialist__action--primary"
            aria-label="Call now"
          >
            <span class="specialist__action-icon" aria-hidden="true">
              <img src="assets/anima/specialist/vector.svg" alt="" />
            </span>
            <span>Call now</span>
          </button>

          <button
            type="button"
            class="specialist__action specialist__action--secondary"
            aria-label="Navigate"
          >
            <span class="specialist__action-icon" aria-hidden="true">
              <img src="assets/anima/specialist/vector-1.svg" alt="" />
            </span>
            <span>Navigate</span>
          </button>
        </div>

        <hr class="specialist__divider" />

        <section class="specialist__section" aria-labelledby="specializations-title">
          <h2 id="specializations-title" class="specialist__section-title">Specializations</h2>

          <ul class="specialist__feature-list">
            <li class="specialist__feature" *ngFor="let spec of currentSpecialist.specializations">
              <span
                class="specialist__feature-icon"
                [ngClass]="{
                  'specialist__feature-icon--midnight': spec.tint === 'midnight',
                  'specialist__feature-icon--mist': spec.tint === 'mist'
                }"
              >
                <img [src]="spec.icon" alt="" [ngStyle]="spec.offsets" />
              </span>

              <div class="specialist__feature-content">
                <span class="specialist__feature-title">
                  <ng-container *ngFor="let line of splitLines(spec.title); let last = last">
                    {{ line }}<br *ngIf="!last" />
                  </ng-container>
                </span>
                <span class="specialist__feature-subtitle">{{ spec.subtitle }}</span>
              </div>
            </li>
          </ul>
        </section>

        <hr class="specialist__divider" />

        <section class="specialist__section" aria-labelledby="availability-title">
          <h2 id="availability-title" class="specialist__section-title">Availability</h2>

          <div class="specialist__availability">
            <span class="specialist__availability-icon" aria-hidden="true">
              <img src="assets/anima/specialist/vector-5.svg" alt="" />
              <img src="assets/anima/specialist/vector-6.svg" alt="" />
            </span>

            <ul class="specialist__availability-times">
              <li *ngFor="let slot of currentSpecialist.availability">{{ slot }}</li>
            </ul>

            <button
              type="button"
              class="specialist__action specialist__action--primary specialist__action--full"
              aria-label="Make an appointment"
            >
              Make an appointment
            </button>
          </div>
        </section>

        <hr class="specialist__divider" />

        <section class="specialist__section" aria-labelledby="contact-title">
          <h2 id="contact-title" class="specialist__section-title">Clinic contacts</h2>

          <div class="specialist__contact-list">
            <div class="specialist__contact-item" *ngFor="let contact of currentSpecialist.contactInfo">
              <span class="specialist__contact-icon" aria-hidden="true">
                <img [src]="contact.icon" alt="" [ngStyle]="contact.offsets" />
              </span>
              <span class="specialist__contact-text">{{ contact.text }}</span>
            </div>
          </div>
        </section>
      </div>
    </ng-container>
  </ng-container>

  <ng-template #loadingState>
    <div class="specialist__status" role="status">Loading specialistâ€¦</div>
  </ng-template>

  <ng-template #notFoundState>
    <div class="specialist__status" role="alert">We couldn't find that specialist.</div>
  </ng-template>
</section>
